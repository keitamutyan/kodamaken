/*
 *for analyzing DHCP_header information
 *Thanks to Samuel Jacob
 */

#define __FAVOR_BSD

#define DHCP_CHADDR_LEN 16
#define DHCP_SNAME_LEN 64
#define DHCP_FILE_LEN 128

typedef struct dhcp_header
{
  u_int8_t opcode;
  u_int8_t htype;
  u_int8_t hw_addr_len;
  u_int8_t hops;
  u_int32_t xid;
  u_int16_t secs;
  u_int16_t flags;
  u_int32_t client_ip;
  u_int32_t your_ip;
  u_int32_t server_ip;
  u_int32_t gateway_ip;
  u_int8_t client_haddr[DHCP_CHADDR_LEN];
  char bp_sname[DHCP_SNAME_LEN];
  char bp_file[DHCP_FILE_LEN];
  uint32_t magic_cookie;
  //u_int8_t bp_options[0];
} dhcp_h;

#define DHCP_BOOTREQUEST 1
#define DHCP_BOOTREPLY 2

#define DHCP_HARDWARE_TYPE_10_ETHERNET 1

#define MESSAGE_TYPE_PAD 0
#define MESSAGE_TYPE_REQ_SUBNET_MASK 1
#define MESSAGE_TYPE_ROUTER 3
#define MESSAGE_TYPE_DNS 6
#define MESSAGE_TYPE_DOMAIN_NAME 15
#define MESSAGE_TYPE_REQ_IP 50
#define MESSAGE_TYPE_DHCP 53
#define MESSAGE_TYPE_PARAMETER_REQ_LIST 55
#define MESSAGE_TYPE_CLIENT_IDENTIFIER 61
#define MESSAGE_TYPE_END 255

#define DHCP_OPTION_DISCOVER 1
#define DHCP_OPTION_OFFER 2
#define DHCP_OPTION_REQUEST 3
#define DHCP_OPTION_PACK 4

#define DHCP_SERVER_PORT 67
#define DHCP_CLIENT_PORT 68

#define DHCP_MAGIC_COOKIE 0x63825363

unsigned short in_cksum(unsigned short *addr, int len);
